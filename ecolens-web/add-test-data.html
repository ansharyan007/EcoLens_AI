<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Test Data - EcoLens AI</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: linear-gradient(135deg, #111827, #1f2937);
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .container {
            max-width: 600px;
            width: 100%;
            background: #1f2937;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: #22c55e;
        }
        
        p {
            color: #9ca3af;
            margin-bottom: 2rem;
        }
        
        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        button {
            padding: 1rem 2rem;
            background: #22c55e;
            border: none;
            border-radius: 0.5rem;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        button:hover {
            background: #16a34a;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #374151;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #3b82f6;
        }
        
        .btn-secondary:hover {
            background: #2563eb;
        }
        
        .btn-danger {
            background: #ef4444;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .log {
            margin-top: 2rem;
            padding: 1rem;
            background: #111827;
            border-radius: 0.5rem;
            max-height: 300px;
            overflow-y: auto;
            font-size: 0.875rem;
            font-family: 'Courier New', monospace;
        }
        
        .log-item {
            padding: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .log-item.success {
            color: #22c55e;
        }
        
        .log-item.error {
            color: #ef4444;
        }
        
        .log-item.info {
            color: #3b82f6;
        }
        
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: #111827;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #22c55e;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: #9ca3af;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔥 Add Test Data</h1>
        <p>Add random data to your Firebase database for testing</p>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="sitesCount">0</div>
                <div class="stat-label">Sites</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="usersCount">0</div>
                <div class="stat-label">Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="reportsCount">0</div>
                <div class="stat-label">Reports</div>
            </div>
        </div>
        
        <div class="btn-group">
            <button id="addAllBtn" onclick="addAllData()">
                <span>Add All Data (50 of each)</span>
            </button>
            
            <button class="btn-secondary" id="addSitesBtn" onclick="addSites()">
                <span>Add 50 Sites</span>
            </button>
            
            <button class="btn-secondary" id="addUsersBtn" onclick="addUsers()">
                <span>Add 50 Users</span>
            </button>
            
            <button class="btn-secondary" id="addReportsBtn" onclick="addReports()">
                <span>Add 50 Reports</span>
            </button>
            
            <button class="btn-danger" id="clearBtn" onclick="clearAllData()">
                <span>Clear All Data</span>
            </button>
        </div>
        
        <div class="log" id="log"></div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Your Firebase Config -->
    <script src="../js/config.js"></script>
    
    <script>
        // Random data generators
        const cities = [
            { name: 'Delhi', country: 'India', lat: 28.7041, lng: 77.1025 },
            { name: 'Mumbai', country: 'India', lat: 19.0760, lng: 72.8777 },
            { name: 'Bangalore', country: 'India', lat: 12.9716, lng: 77.5946 },
            { name: 'Chennai', country: 'India', lat: 13.0827, lng: 80.2707 },
            { name: 'Kolkata', country: 'India', lat: 22.5726, lng: 88.3639 },
            { name: 'Hyderabad', country: 'India', lat: 17.3850, lng: 78.4867 },
            { name: 'Pune', country: 'India', lat: 18.5204, lng: 73.8567 },
            { name: 'Ahmedabad', country: 'India', lat: 23.0225, lng: 72.5714 },
            { name: 'Beijing', country: 'China', lat: 39.9042, lng: 116.4074 },
            { name: 'Shanghai', country: 'China', lat: 31.2304, lng: 121.4737 },
            { name: 'Tokyo', country: 'Japan', lat: 35.6762, lng: 139.6503 },
            { name: 'Seoul', country: 'South Korea', lat: 37.5665, lng: 126.9780 },
            { name: 'London', country: 'UK', lat: 51.5074, lng: -0.1278 },
            { name: 'Paris', country: 'France', lat: 48.8566, lng: 2.3522 },
            { name: 'New York', country: 'USA', lat: 40.7128, lng: -74.0060 }
        ];
        
        const facilityTypes = ['cement', 'steel', 'power', 'refinery', 'chemical', 'manufacturing'];
        const firstNames = ['John', 'Jane', 'Mike', 'Sarah', 'David', 'Emma', 'Chris', 'Lisa', 'Alex', 'Maria'];
        const lastNames = ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez'];
        
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function randomChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }
        
        function log(message, type = 'info') {
            const logEl = document.getElementById('log');
            const item = document.createElement('div');
            item.className = `log-item ${type}`;
            item.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logEl.appendChild(item);
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        function updateStats() {
            db.collection('sites').get().then(snap => {
                document.getElementById('sitesCount').textContent = snap.size;
            });
            db.collection('users').get().then(snap => {
                document.getElementById('usersCount').textContent = snap.size;
            });
            db.collection('reports').get().then(snap => {
                document.getElementById('reportsCount').textContent = snap.size;
            });
        }
        
        function disableButtons() {
            document.querySelectorAll('button').forEach(btn => btn.disabled = true);
        }
        
        function enableButtons() {
            document.querySelectorAll('button').forEach(btn => btn.disabled = false);
        }
        
        // Add 50 Sites
        async function addSites() {
            disableButtons();
            log('Starting to add 50 sites...', 'info');
            
            try {
                for (let i = 0; i < 50; i++) {
                    const city = randomChoice(cities);
                    const facilityType = randomChoice(facilityTypes);
                    const carbonEmissions = randomInt(100, 1000);
                    
                    await db.collection('sites').add({
                        name: `${city.name} ${facilityType.charAt(0).toUpperCase() + facilityType.slice(1)} Plant`,
                        location: new firebase.firestore.GeoPoint(
                            city.lat + (Math.random() - 0.5) * 0.5,
                            city.lng + (Math.random() - 0.5) * 0.5
                        ),
                        carbonEmissions: carbonEmissions,
                        facilityType: facilityType,
                        address: `Industrial Area, ${city.name}, ${city.country}`,
                        verified: Math.random() > 0.3,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    log(`Added site ${i + 1}/50: ${city.name} ${facilityType} Plant`, 'success');
                }
                
                log('✅ Successfully added 50 sites!', 'success');
                updateStats();
            } catch (error) {
                log(`❌ Error: ${error.message}`, 'error');
            }
            
            enableButtons();
        }
        
        // Add 50 Users
        async function addUsers() {
            disableButtons();
            log('Starting to add 50 users...', 'info');
            
            try {
                for (let i = 0; i < 50; i++) {
                    const firstName = randomChoice(firstNames);
                    const lastName = randomChoice(lastNames);
                    const displayName = `${firstName} ${lastName}`;
                    const points = randomInt(100, 5000);
                    
                    const docRef = await db.collection('users').add({
                        displayName: displayName,
                        email: `${firstName.toLowerCase()}.${lastName.toLowerCase()}${randomInt(1, 999)}@example.com`,
                        photoURL: null,
                        bio: 'Environmental advocate | Carbon monitoring enthusiast',
                        points: points,
                        rank: 0,
                        totalReports: randomInt(1, 100),
                        verifiedReports: randomInt(0, 50),
                        badges: [],
                        badgesEarned: randomInt(0, 8),
                        totalBadges: 12,
                        settings: {
                            emailNotifications: true,
                            publicProfile: true,
                            showOnLeaderboard: true
                        },
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastActive: firebase.firestore.FieldValue.serverTimestamp(),
                        memberSince: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Add to leaderboard
                    await db.collection('leaderboard').doc(docRef.id).set({
                        displayName: displayName,
                        photoURL: null,
                        points: points,
                        rank: 0,
                        totalReports: randomInt(1, 100),
                        badges: [],
                        lastActive: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    log(`Added user ${i + 1}/50: ${displayName}`, 'success');
                }
                
                log('✅ Successfully added 50 users!', 'success');
                updateStats();
            } catch (error) {
                log(`❌ Error: ${error.message}`, 'error');
            }
            
            enableButtons();
        }
        
        // Add 50 Reports
        async function addReports() {
            disableButtons();
            log('Starting to add 50 reports...', 'info');
            
            try {
                // Get existing sites and users
                const sitesSnap = await db.collection('sites').limit(10).get();
                const usersSnap = await db.collection('users').limit(10).get();
                
                if (sitesSnap.empty || usersSnap.empty) {
                    log('⚠️ Please add sites and users first!', 'error');
                    enableButtons();
                    return;
                }
                
                const sites = sitesSnap.docs;
                const users = usersSnap.docs;
                
                for (let i = 0; i < 50; i++) {
                    const site = randomChoice(sites);
                    const user = randomChoice(users);
                    const siteData = site.data();
                    const userData = user.data();
                    
                    await db.collection('reports').add({
                        siteId: site.id,
                        siteName: siteData.name,
                        userId: user.id,
                        userName: userData.displayName,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        carbonEstimate: randomInt(100, 1000),
                        aiConfidence: Math.random() * 0.3 + 0.7, // 0.7 to 1.0
                        facilityType: siteData.facilityType,
                        notes: 'Detected during routine monitoring',
                        imageUrl: 'https://via.placeholder.com/400',
                        verified: Math.random() > 0.3,
                        violationDetected: Math.random() > 0.7,
                        platform: Math.random() > 0.5 ? 'web' : 'mobile'
                    });
                    
                    log(`Added report ${i + 1}/50`, 'success');
                }
                
                log('✅ Successfully added 50 reports!', 'success');
                updateStats();
            } catch (error) {
                log(`❌ Error: ${error.message}`, 'error');
            }
            
            enableButtons();
        }
        
        // Add all data
        async function addAllData() {
            disableButtons();
            log('🚀 Adding ALL data (Sites → Users → Reports)...', 'info');
            
            await addSites();
            await addUsers();
            await addReports();
            
            log('✅ ALL DATA ADDED SUCCESSFULLY!', 'success');
            enableButtons();
        }
        
        // Clear all data
        async function clearAllData() {
            if (!confirm('Are you sure you want to delete ALL data? This cannot be undone!')) {
                return;
            }
            
            disableButtons();
            log('🗑️ Clearing all data...', 'info');
            
            try {
                // Delete sites
                const sitesSnap = await db.collection('sites').get();
                for (const doc of sitesSnap.docs) {
                    await doc.ref.delete();
                }
                log(`Deleted ${sitesSnap.size} sites`, 'info');
                
                // Delete users
                const usersSnap = await db.collection('users').get();
                for (const doc of usersSnap.docs) {
                    await doc.ref.delete();
                }
                log(`Deleted ${usersSnap.size} users`, 'info');
                
                // Delete reports
                const reportsSnap = await db.collection('reports').get();
                for (const doc of reportsSnap.docs) {
                    await doc.ref.delete();
                }
                log(`Deleted ${reportsSnap.size} reports`, 'info');
                
                // Delete leaderboard
                const leaderboardSnap = await db.collection('leaderboard').get();
                for (const doc of leaderboardSnap.docs) {
                    await doc.ref.delete();
                }
                log(`Deleted ${leaderboardSnap.size} leaderboard entries`, 'info');
                
                log('✅ All data cleared!', 'success');
                updateStats();
            } catch (error) {
                log(`❌ Error: ${error.message}`, 'error');
            }
            
            enableButtons();
        }
        
        // Load initial stats
        updateStats();
        log('Ready! Click a button to add data.', 'info');
    </script>
</body>
</html>
